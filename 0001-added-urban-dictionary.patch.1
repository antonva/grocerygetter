From 253efee2872fd175403300a12d8c1291d45a0ace Mon Sep 17 00:00:00 2001
From: azk <lol@no.way>
Date: Sun, 16 Aug 2015 18:53:55 +0000
Subject: [PATCH] added urban dictionary

---
 commands.py | 26 ++++++++++++++++++++++++++
 1 file changed, 26 insertions(+)

diff --git a/commands.py b/commands.py
index 3665f90..e0ee162 100644
--- a/commands.py
+++ b/commands.py
@@ -6,6 +6,8 @@ import string
 import re
 import requests
 
+from bs4 import BeautifulSoup
+

 class tcol:
         NORMAL = u"\u000f"
@@ -410,6 +412,30 @@ def spooky(args):
     directory = os.path.dirname(__file__)
     spook = directory + os.path.join("/texts/other/spooks")
     return random.choice(list(open(spook)))
+
+@command("ud")
+def ud(args):
+    definitions = []
+    if args["args"]:
+        payload = {"term" : str(args["args"][0])}
+        r = requests.get("https://www.urbandictionary.com/define.php", params=payload)
+        if r.status_code == 200:
+            soup = BeautifulSoup(r.text, "html.parser")
+            title = soup.title.string[18:]
+            l = soup.find_all("div", class_= "meaning")
+            for e in l:
+                definitions.append(re.sub("\r<br/>", " ", re.sub("~", "", str(e).split('\n')[1])))
+            if len(args["args"]) == 2:
+                try:
+                    data = tcol.BOLD + title + ": " + tcol.NORMAL +  definitions[int(args["args"][1])-1] + tcol.BOLD + " [" + args["args"][1] + "/" + str(len(definitions)) + "]"
+                    return data
+                except TypeError:
+                    pass
+            data = tcol.BOLD + title + ": " + tcol.NORMAL + definitions[0] + tcol.BOLD + " [" + "1/" + str(len(definitions)) + "]"
+            return data
+        else:
+            return "No definition found in UD."
+
    
 def breaklines(str):  # This function breaks lines at \n and sends the split lines to where they need to go
     strarray = string.split(str, "\n")
-- 
2.4.5

